install.packages('corrgram')
setwd("~/OneDrive/shared files/Bligh Tanner/masters/data")
?knitr
setwd("~/OneDrive/shared files/Bligh Tanner/masters/data")
all6a<- read.csv('all6a.csv')[,-1]
?opts_knit
opts_knit$set(root.dir= "~/OneDrive/shared files/Bligh Tanner/masters/data")
library('knitr')
opts_knit$set(root.dir= "~/OneDrive/shared files/Bligh Tanner/masters/data")
test<- cor.test(all7a$return.pdol, all7a[,cor.all[i]], method = c('pearson')
test<- cor.test(all7a$return.pdol, all7a[,cor.all[i]], method = c('pearson'))
all7<- read.csv('all7.csv')[,-1]
all7a<- all7 %>% filter(return.pdol <=3 & return.pdol> -2)
all7a<- all7 %>% select(-Paperless,-Innovation, -JobInvCount,-job.first.inv.email.Sent,
-Total.Costs..AUD., -Stage, -Folders, -Total.Fee, -Disburse, -Subcon.fee,
-Job.Size, -Tot.Invoiced, -charge, -cost, -Dis.subcon, -hours,-profit,-balance,
-Role)
library('magrittr')
library('ggplot2')
library("dplyr")
library("plyr")
library('magrittr')
library('reshape2')
library("rpart")
library('car')
library('e1071')
library('corrgram')
all7a<- all7 %>% filter(return.pdol <=3 & return.pdol> -2)
all7a<- all7 %>% select(-Paperless,-Innovation, -JobInvCount,-job.first.inv.email.Sent,
-Total.Costs..AUD., -Stage, -Folders, -Total.Fee, -Disburse, -Subcon.fee,
-Job.Size, -Tot.Invoiced, -charge, -cost, -Dis.subcon, -hours,-profit,-balance,
-Role)
test<- cor.test(all7a$return.pdol, all7a[,cor.all[i]], method = c('pearson'))
cor.all<- c("client.count", "no.users", "pc.director", "pc.gradpro", "pc.midpro",
"pc.midtech", "pc.contracttech", "return.pdol","Inv.freq", 'num.neginv','client.invfreq','client.neginv',
"pc.seniorpro", "pc.seniortech", "no.employees", "dist", "Num.disc",'client.numinv',
"pc.unknown", "pc.pro", "pc.tech", "Year", "Num.days", "mean.peeps", "hours.perday", "hrs.mlsto",
"cost.mlsto",
"dis.sc.mlsto", "inv.mlsto", "num.inv", "mean.inv", "client.meaninv", "client.totinv",
"timespan")
test<- cor.test(all7a$return.pdol, all7a[,cor.all[i]], method = c('pearson'))
i=1
test<- cor.test(all7a$return.pdol, all7a[,cor.all[i]], method = c('pearson'))
summary(test)
test
str(test)
test$p.value
test$estimate
summ<- data.frame("test"=rep(NA, length(cor.all)*2),
'p.val' = rep(0, length(cor.all)*2),
'corr' = rep(0, length(cor.all)*2))
head(summ)
i
a = cor.test(all7a$return.pdol, all7a[,cor.all[i]], method = c('pearson'))
b = cor.test(all7a$return.pdol, all7a[,cor.all[i]], method = c('kendall'))
a[i]$p.val
a[i] = cor.test(all7a$return.pdol, all7a[,cor.all[i]], method = c('pearson'))
a = cor.test(all7a$return.pdol, all7a[,cor.all[i]], method = c('pearson'))
b = cor.test(all7a$return.pdol, all7a[,cor.all[i]], method = c('kendall'))
a$p.val
inter.summ = data.frame('test'= c('pearson','kendall'),
'var' = c(cor.all[i], cor.all[i]),
'p.val' = c(a$p.val, b$p.val),
'corr' = c(a$estimate, b$estimate)
)
inter.sum
inter.summ
cor.all<- c("client.count", "no.users")
summ<- data.frame("test"=rep(NA, length(cor.all)*2),
'var' = rep(NA, length(cor.all)*2),
'p.val' = rep(0, length(cor.all)*2),
'corr' = rep(0, length(cor.all)*2))
for(i in 1:length(cor.all)) {
a = cor.test(all7a$return.pdol, all7a[,cor.all[i]], method = c('pearson'))
b = cor.test(all7a$return.pdol, all7a[,cor.all[i]], method = c('kendall'))
inter.summ = data.frame('test'= c('pearson','kendall'),
'var' = c(cor.all[i], cor.all[i]),
'p.val' = c(a$p.val, b$p.val),
'corr' = c(a$estimate, b$estimate))
summ = rbind(summ,inter.summ)
}
summ
summ<- data.frame("test"=NULL,
'var' = NULL,
'p.val' = NULL,
'corr' = NULL)
for(i in 1:length(cor.all)) {
a = cor.test(all7a$return.pdol, all7a[,cor.all[i]], method = c('pearson'))
b = cor.test(all7a$return.pdol, all7a[,cor.all[i]], method = c('kendall'))
inter.summ = data.frame('test'= c('pearson','kendall'),
'var' = c(cor.all[i], cor.all[i]),
'p.val' = c(a$p.val, b$p.val),
'corr' = c(a$estimate, b$estimate))
summ = rbind(summ,inter.summ)
}
summ
c(a$p.val, b$p.val) %>% round(2)
a = cor.test(all7a$return.pdol, all7a[,cor.all[i]], method = c('pearson'))
b = cor.test(all7a$return.pdol, all7a[,cor.all[i]], method = c('kendall'))
c(a$p.val, b$p.val) %>% round(2)
round(c(a$p.val, b$p.val),2)
summ$p.val <- summ$p.val %>% round(2)
summ$p.val
summ$p.val <- format(summ$p.val, scientific=TRUE, digits = 3)
summ$p.val
for(i in 1:length(cor.all)) {
a = cor.test(all7a$return.pdol, all7a[,cor.all[i]], method = c('pearson'))
b = cor.test(all7a$return.pdol, all7a[,cor.all[i]], method = c('kendall'))
inter.summ = data.frame('test'= c('pearson','kendall'),
'var' = c(cor.all[i], cor.all[i]),
'p.val' = c(a$p.val, b$p.val),
'corr' = c(a$estimate, b$estimate))
summ = rbind(summ,inter.summ)
}
summ$p.val
summ<- data.frame("test"=NULL,
'var' = NULL,
'p.val' = NULL,
'corr' = NULL)
for(i in 1:length(cor.all)) {
a = cor.test(all7a$return.pdol, all7a[,cor.all[i]], method = c('pearson'))
b = cor.test(all7a$return.pdol, all7a[,cor.all[i]], method = c('kendall'))
inter.summ = data.frame('test'= c('pearson','kendall'),
'var' = c(cor.all[i], cor.all[i]),
'p.val' = c(a$p.val, b$p.val),
'corr' = c(a$estimate, b$estimate))
summ = rbind(summ,inter.summ)
}
summ$p.val
format(summ$p.val, scientific=TRUE, digits = 3)
summ$corr <- round(summ$corr, 3)
summ
summ$p.val <- format(summ$p.val, scientific=TRUE, digits = 3)
summ
cor.all<- c("client.count", "no.users", "pc.director", "pc.gradpro", "pc.midpro",
"pc.midtech", "pc.contracttech", "return.pdol","Inv.freq", 'num.neginv','client.invfreq','client.neginv',
"pc.seniorpro", "pc.seniortech", "no.employees", "dist", "Num.disc",'client.numinv',
"pc.unknown", "pc.pro", "pc.tech", "Year", "Num.days", "mean.peeps", "hours.perday", "hrs.mlsto",
"cost.mlsto",
"dis.sc.mlsto", "inv.mlsto", "num.inv", "mean.inv", "client.meaninv", "client.totinv",
"timespan")
summ<- data.frame("test"=rep(NA, length(cor.all)*2),
'var' = rep(NA, length(cor.all)*2),
'p.val' = rep(0, length(cor.all)*2),
'corr' = rep(0, length(cor.all)*2))
summ<- data.frame("test"=NULL,
'var' = NULL,
'corr' = NULL,
'p.val' = NULL)
for(i in 1:length(cor.all)) {
a = cor.test(all7a$return.pdol, all7a[,cor.all[i]], method = c('pearson'))
b = cor.test(all7a$return.pdol, all7a[,cor.all[i]], method = c('kendall'))
inter.summ = data.frame('test'= c('pearson','kendall'),
'var' = c(cor.all[i], cor.all[i]),
'corr' = c(a$estimate, b$estimate),
'p.val' = c(a$p.val, b$p.val))
summ = rbind(summ,inter.summ)
}
summ$p.val <- format(summ$p.val, scientific=TRUE, digits = 3)
summ$corr <- round(summ$corr, 3)
summ %>% arrange(test, p.val)
class(summ$p.val)
summ$p.val <- as.numeric(summ$p.val)
class(summ$p.val)
summ %>% arrange(test, p.val)
summ %>% arrange(test, abs(corr))
summ %>% arrange(test, -abs(corr))
summ %>% filter(p.val<= 0.05) %>% (arrange(test, -abs(corr))
summ %>% filter(p.val<= 0.05) %>% arrange(test, -abs(corr)
summ %>% filter(p.val<= 0.05) %>% arrange(test, -abs(corr))
summ %>% filter(p.val<= 0.05, test== 'kendall') %>% arrange(test, -abs(corr)) %>% select(var) %>%
filter(var== -c(cost.mlsto, hrs.mlsto, Num.days, dis.sc.mlsto, num.neginv, Year)
summ %>% filter(p.val<= 0.05, test== 'kendall') %>% arrange(test, -abs(corr)) %>% select(var) %>%
filter(var== -c(cost.mlsto, hrs.mlsto, Num.days, dis.sc.mlsto, num.neginv, Year))
summ %>% filter(p.val<= 0.05, test== 'kendall') %>% arrange(test, -abs(corr)) %>% select(var) %>%
filter(var== -c('cost.mlsto', 'hrs.mlsto', 'Num.days', 'dis.sc.mlsto', 'num.neginv', 'Year'))
summ %>% filter(p.val<= 0.05, test== 'kendall') %>% arrange(test, -abs(corr)) %>% select(var) %>%
filter(var== !c('cost.mlsto', 'hrs.mlsto', 'Num.days', 'dis.sc.mlsto', 'num.neginv', 'Year'))
summ %>% filter(p.val<= 0.05, test== 'kendall') %>% arrange(test, -abs(corr)) %>% select(var) %>%
filter(var!=c('cost.mlsto', 'hrs.mlsto', 'Num.days', 'dis.sc.mlsto', 'num.neginv', 'Year'))
summ %>% filter(var != 'cost.mlsto')
summ %>% filter(var != c('cost.mlsto', 'hrs.mlsto')
summ %>% filter(var != c('cost.mlsto', 'hrs.mlsto'))
summ %>% filter(var != c('cost.mlsto')
summ %>% filter(var != c('cost.mlsto'))
summ %>% filter(var != 'cost.mlsto'|'hrs.mlsto')
summ %>% filter(var != 'cost.mlsto|hrs.mlsto')
summ %>% filter(var != c('cost.mlsto|hrs.mlsto'))
summ %>% filter(var != c('cost.mlsto','hrs.mlsto'))
summ %>% filter(var != c('cost.mlsto'|'hrs.mlsto'))
summ %>% filter(var != 'cost.mlsto', var != 'hrs.mlsto'
summ %>% filter(var != 'cost.mlsto', var != 'hrs.mlsto')
summ %>% filter(p.val<= 0.05, test== 'kendall') %>% arrange(test, -abs(corr)) %>% select(var) %>%
filter(var!= 'cost.mlsto', var!= 'hrs.mlsto', var!= 'Num.days', var!= 'dis.sc.mlsto',
var!= 'num.neginv',var!= 'Year')
summ %>% filter(p.val<= 0.05, test== 'kendall') %>% arrange(test, -abs(corr)) %>% select(var) %>%
filter(var!= 'cost.mlsto', var!= 'hrs.mlsto', var!= 'Num.days', var!= 'dis.sc.mlsto',
var!= 'num.neginv',var!= 'Year', var!= 'return.pdol')
summ %>% filter(p.val<= 0.05, test== 'kendall') %>% arrange(test, -abs(corr)) %>% select(var, p.val) %>%
filter(var!= 'cost.mlsto', var!= 'hrs.mlsto', var!= 'Num.days', var!= 'dis.sc.mlsto',
var!= 'num.neginv',var!= 'Year', var!= 'return.pdol')
summ %>% filter(p.val<= 0.05, test== 'kendall') %>% arrange(test, -abs(corr)) %>%
select(var, p.val, corr) %>%
filter(var!= 'cost.mlsto', var!= 'hrs.mlsto', var!= 'Num.days', var!= 'dis.sc.mlsto',
var!= 'num.neginv',var!= 'Year', var!= 'return.pdol')
