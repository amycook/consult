<<<<<<< Updated upstream
df[,predict] %>% head
df[new.cases,predict]
df$pc.pro %>% head
df[new.cases,predict]
?knn
invo.knn = knn(df[,predict], df[new.cases,predict],
df$pc.pro, k=k)
head(invo.knn)
indices<- attr(invo.knn,  "nn.index")
indices
df %>% slice(c(new.cases, indices[1,]))
indices[1,]
indicies
omdoces
indices
vars.vec<- c('Discipline','Business','Biz.type','code.contact', 'code.client', 'JD.Second', 'Billing.Type')
vars= vars.vec
df= all7d
options("contrasts")
bin.knn= NULL
i=1
temp = data.frame(df[, vars[i]])
head(temp)
colnames(temp)<- c(vars[i])
head(temp)
formula = paste('~',vars[i],'-1')
formula
a= model.matrix( as.formula(formula), temp)
head(a)
a= a[match(rownames(temp), rownames(a)),]
a= model.matrix( as.formula(formula), temp)
head(a)
head(temp)
bin.knn= cbind(bin.knn,a)
head(bin.knn)
shiny::runApp('final_app')
head(e())
head(e)
e
head(test)
head(c)
head(c())
k1
head(k1)
knn.binary<- binary.build(vars= vars.vec, df= all7d)
binary.build<- function(vars= vars.vec, df= all7d){
options("contrasts")
#create final df bin.knn
bin.knn= NULL
#loop through each variable in vars vector
for(i in 1:length(vars.vec)){
temp = data.frame(df[, vars[i]])
colnames(temp)<- c(vars[i])
formula = paste('~',vars[i],'-1')
a= model.matrix( as.formula(formula), temp)
a= a[match(rownames(temp), rownames(a)),]
bin.knn= cbind(bin.knn,a)
}
return(bin.knn)
}
knn.binary<- binary.build(vars= vars.vec, df= all7d)
knn.binary<- as.data.frame(knn.binary)
#NA values don't work in knn function so turn all NA into zeroes
knn.binary[is.na(knn.binary)]<- 0
knn.binary$pc.pro<- all7d$pc.pro
knn.binary$mlsto<- all7d$mlsto
bin<- knn.binary %>% select(-mlsto)
head(knn.binary)
knn.binary$mlsto<- all7d$mlsto
bin<- knn.binary %>% select(-mlsto)
head(all7d$mlsto)
all7d<- read.csv('all7d.csv')[,-1]
all7d<- read.csv('C:/Users/n9232371/OneDrive/shared files/Bligh Tanner/masters/data/all7d.csv')[,-1]
all7d$mlsto<- as.character(all7d$mlsto)
# test.case<- all7d %>% select(Discipline, Business, Biz.type, code.contact, code.client, JD.Second, Billing.Type)
#function for retrieving nearest neighbours by inv.mlsto:
inv.knn<- function(df= all7d, predict= 'inv.mlsto', new.cases= c(1000), k=3){
invo.knn = knn(df[,predict], df[new.cases,predict],
df$pc.pro, k=k)
indices<- attr(invo.knn,  "nn.index")
#checkout the nearest neigbours!
df %>% slice(c(new.cases, indices[1,])) %>% return
}
vars.vec<- c('Discipline','Business','Biz.type','code.contact', 'code.client', 'JD.Second', 'Billing.Type')
knn.binary<- binary.build(vars= vars.vec, df= all7d)
knn.binary<- as.data.frame(knn.binary)
#NA values don't work in knn function so turn all NA into zeroes
knn.binary[is.na(knn.binary)]<- 0
knn.binary$pc.pro<- all7d$pc.pro
knn.binary$mlsto<- all7d$mlsto
bin<- knn.binary %>% select(-mlsto)
cat.knn<- function(df= all7d, nn.by= 'inv.mlsto', predict='pc.pro', case= c(1000), k=3, result.df= all7d){
invo.knn = knn(df[,nn.by], df[case,nn.by],
df[,predict], k=k)
indices= attr(invo.knn,  "nn.index")
dists= attr(invo.knn, 'nn.dist') %>% t %>% as.data.frame %>% round(2)
#checkout the nearest neigbours!
final = cbind(result.df %>% slice(c(indices[1,])), dists)
colnames(final)[names(final) %in% 'V1']<-'knn.dist'
#final actions
assign('index', indices, envir=.GlobalEnv)
return(final)
}
head(bin)
b = cat.knn(df= bin, nn.by= colnames(bin)[!grepl('pc.pro', colnames(bin))],
predict = 'pc.pro', case= input$case, k=10, result.df= all7d)
b = cat.knn(df= bin, nn.by= colnames(bin)[!grepl('pc.pro', colnames(bin))],
predict = 'pc.pro', case= 80, k=10, result.df= all7d)
head(b)
inv.knn(df= b, predict= 'inv.mlsto', new.cases= 1, k=5) %>% slice(-1)
c = inv.knn(df= b, predict= 'inv.mlsto', new.cases= 1, k=5) %>% slice(-1)
head(c)
ggplot(b, aes_string(x = 'return.pdol', y = 'inv.mlsto')) +
geom_point(aes_string(size = 'timespan', colour = 'code.client'))
ggplot(b, aes_string(x = 'inv.mlsto', y = 'return.pdol')) +
geom_point(aes_string(size = 'timespan', colour = 'code.client'))
ggplot(b, aes_string(x = 'timespan', y = 'return.pdol')) +
geom_point(aes_string(size = 'inv.mlsto', colour = 'code.client'))
ggplot(b, aes_string(x = 'timespan', y = 'return.pdol')) +
geom_point(aes_string(size = 'inv.mlsto', colour = 'code.client')) +
labs(title = "Similar Jobs", x = "Return per Dollar", y = "Timespan (days)")
ggplot(b, aes_string(x = 'timespan', y = 'return.pdol')) +
geom_point(aes_string(size = 'inv.mlsto', colour = 'code.client')) +
labs(title = "Similar Jobs", y = "Return per Dollar", x = "Timespan (days)")
ggplot(b, aes_string(x = 'timespan', y = 'return.pdol')) +
geom_point(aes_string(size = 'inv.mlsto', colour = 'code.client')) +
labs(title = "Similar Jobs", y = "Return per Dollar", x = "Timespan (days)",
colour = "Client", size = "Invoiced Amount")
shiny::runApp('final_app')
ggplot(b, aes_string(x = 'timespan', y = 'return.pdol')) +
geom_point(aes_string(size = 'inv.mlsto', colour = 'code.client')) +
labs(title = "Similar Jobs", y = "Return per Dollar", x = "Timespan (days)",
colour = "Client", size = "Invoiced Amount ($)") +
geom_text(aes(label = mlsto), check_overlap = TRUE)
ggplot(b, aes_string(x = 'timespan', y = 'return.pdol')) +
geom_point(aes_string(size = 'inv.mlsto', colour = 'code.client')) +
labs(title = "Similar Jobs", y = "Return per Dollar", x = "Timespan (days)",
colour = "Client", size = "Invoiced Amount ($)") +
geom_text(aes(label = mlsto), check_overlap = TRUE, hjust = 0, nudge_x = 0.05)
ggplot(b, aes_string(x = 'timespan', y = 'return.pdol')) +
geom_point(aes_string(size = 'inv.mlsto', colour = 'code.client')) +
labs(title = "Similar Jobs", y = "Return per Dollar", x = "Timespan (days)",
colour = "Client", size = "Invoiced Amount ($)") +
geom_text(aes(label = mlsto), check_overlap = TRUE, hjust = 0, nudge_x = 0.1,
nudge_y = -0.1)
ggplot(b, aes_string(x = 'timespan', y = 'return.pdol')) +
geom_point(aes_string(size = 'inv.mlsto', colour = 'code.client')) +
labs(title = "Similar Jobs", y = "Return per Dollar", x = "Timespan (days)",
colour = "Client", size = "Invoiced Amount ($)") +
geom_text(aes(label = mlsto), check_overlap = TRUE, hjust = 0, nudge_x = 0.1,
nudge_y = -0.04)
shiny::runApp('final_app')
shiny::runApp('final_app')
ggplot(b, aes_string(x = 'timespan', y = 'return.pdol')) +
geom_point(aes_string(size = 'inv.mlsto', colour = 'code.client')) +
labs(title = "Similar Jobs", y = "Return per Dollar", x = "Timespan (days)",
colour = "Client", size = "Invoiced Amount ($)") +
geom_text(aes(label = mlsto), check_overlap = TRUE, hjust = 0, nudge_x = 0.1,
nudge_y = -0.04) +
scale_colour_brewer(palette = "Spectral")
b
b$code.client <- c('a','b','c','d','e','f','g','h','i','j','l')
b$code.client <- c('a','b','c','d','e','f','g','h','i','j','l','m')
b$code.client <- c('a','b','c','d','e','f','g','h','i','j')
ggplot(b, aes_string(x = 'timespan', y = 'return.pdol')) +
geom_point(aes_string(size = 'inv.mlsto', colour = 'code.client')) +
labs(title = "Similar Jobs", y = "Return per Dollar", x = "Timespan (days)",
colour = "Client", size = "Invoiced Amount ($)") +
geom_text(aes(label = mlsto), check_overlap = TRUE, hjust = 0, nudge_x = 0.1,
nudge_y = -0.04) +
scale_colour_brewer(palette = "Spectral")
ggplot(b, aes_string(x = 'timespan', y = 'return.pdol')) +
geom_point(aes_string(size = 'inv.mlsto', colour = 'code.client')) +
labs(title = "Similar Jobs", y = "Return per Dollar", x = "Timespan (days)",
colour = "Client", size = "Invoiced Amount ($)") +
geom_text(aes(label = mlsto), check_overlap = TRUE, hjust = 0, nudge_x = 0.1,
nudge_y = -0.04) +
scale_colour_brewer(palette = "Set 1")
ggplot(b, aes_string(x = 'timespan', y = 'return.pdol')) +
geom_point(aes_string(size = 'inv.mlsto', colour = 'code.client')) +
labs(title = "Similar Jobs", y = "Return per Dollar", x = "Timespan (days)",
colour = "Client", size = "Invoiced Amount ($)") +
geom_text(aes(label = mlsto), check_overlap = TRUE, hjust = 0, nudge_x = 0.1,
nudge_y = -0.04) +
scale_colour_brewer(palette = "Set1")
ggplot(b, aes_string(x = 'timespan', y = 'return.pdol')) +
geom_point(aes_string(size = 'inv.mlsto', colour = 'code.client')) +
labs(title = "Similar Jobs", y = "Return per Dollar", x = "Timespan (days)",
colour = "Client", size = "Invoiced Amount ($)") +
geom_text(aes(label = mlsto), check_overlap = TRUE, hjust = 0, nudge_x = 0.1,
nudge_y = -0.04) +
scale_colour_brewer(palette = "Set3")
ggplot(b, aes_string(x = 'timespan', y = 'return.pdol')) +
geom_point(aes_string(size = 'inv.mlsto', colour = 'code.client')) +
labs(title = "Similar Jobs", y = "Return per Dollar", x = "Timespan (days)",
colour = "Client", size = "Invoiced Amount ($)") +
geom_text(aes(label = mlsto), check_overlap = TRUE, hjust = 0, nudge_x = 0.1,
nudge_y = -0.04) +
scale_colour_brewer(palette = "Accent")
ggplot(b, aes_string(x = 'timespan', y = 'return.pdol')) +
geom_point(aes_string(size = 'inv.mlsto', colour = 'code.client')) +
labs(title = "Similar Jobs", y = "Return per Dollar", x = "Timespan (days)",
colour = "Client", size = "Invoiced Amount ($)") +
geom_text(aes(label = mlsto), check_overlap = TRUE, hjust = 0, nudge_x = 0.1,
nudge_y = -0.04) +
scale_colour_brewer(palette = "Paired")
ggplot(b, aes_string(x = 'timespan', y = 'return.pdol')) +
geom_point(aes_string(size = 'inv.mlsto', colour = 'code.client')) +
labs(title = "Similar Jobs", y = "Return per Dollar", x = "Timespan (days)",
colour = "Client", size = "Invoiced Amount ($)") +
geom_text(aes(label = mlsto), check_overlap = TRUE, hjust = 0, nudge_x = 0.1,
nudge_y = -0.04) +
scale_colour_brewer(palette = "Accent")
ggplot(b, aes_string(x = 'timespan', y = 'return.pdol')) +
geom_point(aes_string(size = 'inv.mlsto', colour = 'code.client'), alpha = 0.6) +
labs(title = "Similar Jobs", y = "Return per Dollar", x = "Timespan (days)",
colour = "Client", size = "Invoiced Amount ($)") +
geom_text(aes(label = mlsto), check_overlap = TRUE, hjust = 0, nudge_x = 0.1,
nudge_y = -0.04) +
scale_colour_brewer(palette = "Accent")
ggplot(b, aes_string(x = 'timespan', y = 'return.pdol')) +
geom_point(aes_string(size = 'inv.mlsto', colour = 'code.client'),
alpha = 0.6, shape = 16) +
labs(title = "Similar Jobs", y = "Return per Dollar", x = "Timespan (days)",
colour = "Client", size = "Invoiced Amount ($)") +
geom_text(aes(label = mlsto), check_overlap = TRUE, hjust = 0, nudge_x = 0.1,
nudge_y = -0.04) +
scale_colour_brewer(palette = "Accent")
ggplot(b, aes_string(x = 'timespan', y = 'return.pdol')) +
geom_point(aes_string(size = 'inv.mlsto', colour = 'code.client'),
alpha = 0.6, shape = 16) +
labs(title = "Similar Jobs", y = "Return per Dollar", x = "Timespan (days)",
colour = "Client", size = "Invoiced Amount ($)") +
geom_text(aes(label = mlsto), check_overlap = TRUE, hjust = 0, nudge_x = 0.1,
nudge_y = -0.04) +
scale_colour_brewer(palette = "Spectral")
ggplot(b, aes_string(x = 'timespan', y = 'return.pdol')) +
geom_point(aes_string(size = 'inv.mlsto', colour = 'code.client'),
alpha = 0.7, shape = 16) +
labs(title = "Similar Jobs", y = "Return per Dollar", x = "Timespan (days)",
colour = "Client", size = "Invoiced Amount ($)") +
geom_text(aes(label = mlsto), check_overlap = TRUE, hjust = 0, nudge_x = 0.1,
nudge_y = -0.04) +
scale_colour_brewer(palette = "Spectral")
ggplot(b, aes_string(x = 'timespan', y = 'return.pdol')) +
geom_point(aes_string(size = 'inv.mlsto', colour = 'code.client'),
alpha = 0.7, shape = 16) +
labs(title = "Similar Jobs", y = "Return per Dollar", x = "Timespan (days)",
colour = "Client", size = "Invoiced Amount ($)") +
geom_text(aes(label = mlsto), check_overlap = TRUE, hjust = 0, nudge_x = 0.1,
nudge_y = -0.04) +
scale_colour_brewer(palette = "Set3")
ggplot(b, aes_string(x = 'timespan', y = 'return.pdol')) +
geom_point(aes_string(size = 'inv.mlsto', colour = 'code.client'),
alpha = 0.7, shape = 16) +
labs(title = "Similar Jobs", y = "Return per Dollar", x = "Timespan (days)",
colour = "Client", size = "Invoiced Amount ($)") +
geom_text(aes(label = mlsto), check_overlap = TRUE, hjust = 0, nudge_x = 0.1,
nudge_y = -0.04) +
scale_colour_brewer(palette = "Set2")
ggplot(b, aes_string(x = 'timespan', y = 'return.pdol')) +
geom_point(aes_string(size = 'inv.mlsto', colour = 'code.client'),
alpha = 0.7, shape = 16) +
labs(title = "Similar Jobs", y = "Return per Dollar", x = "Timespan (days)",
colour = "Client", size = "Invoiced Amount ($)") +
geom_text(aes(label = mlsto), check_overlap = TRUE, hjust = 0, nudge_x = 0.1,
nudge_y = -0.04) +
scale_colour_brewer(palette = "Paired")
ggplot(b, aes_string(x = 'timespan', y = 'return.pdol')) +
geom_point(aes_string(size = 'inv.mlsto', colour = 'code.client'),
alpha = 0.7, shape = 16) +
labs(title = "Similar Jobs", y = "Return per Dollar", x = "Timespan (days)",
colour = "Client", size = "Invoiced Amount ($)") +
geom_text(aes(label = mlsto), check_overlap = TRUE, hjust = 0, nudge_x = 0.1,
nudge_y = -0.04) +
scale_colour_brewer(palette = "Accent")
ggplot(b, aes_string(x = 'timespan', y = 'return.pdol')) +
geom_point(aes_string(size = 'inv.mlsto', colour = 'code.client'),
alpha = 0.7, shape = 16) +
labs(title = "Similar Jobs", y = "Return per Dollar", x = "Timespan (days)",
colour = "Client", size = "Invoiced Amount ($)") +
geom_text(aes(label = mlsto), check_overlap = TRUE, hjust = 0, nudge_x = 0.1,
nudge_y = -0.04) +
scale_colour_brewer(palette = "Set1")
shiny::runApp('final_app')
shiny::runApp('final_app')
head(b)
shiny::runApp('final_app')
ggplot(b, aes_string(x = 'no.users', y = 'return.pdol')) +
geom_point(aes_string(size = 'inv.mlsto', colour = 'code.client'),
alpha = 0.6, shape = 16) +
labs(title = "Similar Jobs", y = "Return per Dollar", x = "Number of Users",
colour = "Client", size = "Invoiced Amount ($)") +
geom_text(aes(label = mlsto), check_overlap = TRUE, hjust = 0, nudge_x = 0.1,
nudge_y = -0.04) +
scale_colour_brewer(palette = "Set1") +
ylim(-1, NA)
shiny::runApp('final_app')
shiny::runApp('final_app')
library('shiny',lib='C:/Progra~1/R/R-3.2.2/library')
library('shinythemes',lib='C:/Progra~1/R/R-3.2.2/library')
shiny::runApp('final_app')
shiny::runApp('final_app')
shiny::runApp('final_app')
head(b)
shiny::runApp('final_app')
ggplot(b, aes_string(x = 'inv.mlsto', y = 'return.pdol')) +
geom_point(aes_string(size = 'pc.majpos', colour = 'code.client'),
alpha = 0.6, shape = 16) +
scale_size(range = c(2,4))
shiny::runApp('final_app')
shiny::runApp('final_app')
shiny::runApp('final_app')
ggplot(b, aes_string(x = 'inv.mlsto', y = 'return.pdol')) +
geom_point(aes_string(size = 'timespan', colour = 'code.client'),
alpha = 0.6, shape = 16) +
scale_size(range = c(0,10))
ggplot(b, aes_string(x = 'inv.mlsto', y = 'return.pdol')) +
geom_point(aes_string(size = 'timespan', colour = 'code.client'),
alpha = 0.6, shape = 16) +
scale_size(range = c(5,10))
ggplot(b, aes_string(x = 'inv.mlsto', y = 'return.pdol')) +
geom_point(aes_string(size = 'timespan', colour = 'code.client'),
alpha = 0.6, shape = 16) +
scale_size(range = c(5,13))
shiny::runApp('final_app')
shiny::runApp('final_app')
shiny::runApp('final_app')
shiny::runApp('final_app')
shiny::runApp('final_app')
shiny::runApp('final_app')
shiny::runApp('final_app')
shiny::runApp('final_app')
shiny::runApp('final_app')
install.packages('shiny',lib='C:/Progra~1/R/R-3.2.2/library')
install.packages("shiny", lib = "C:/Progra~1/R/R-3.2.2/library")
install.packages('shiny',lib='C:/Progra~1/R/R-3.2.3/library')
install.packages("shiny", lib = "C:/Progra~1/R/R-3.2.3/library")
library('shinythemes',lib='C:/Progra~1/R/R-3.2.3/library')
library('shiny',lib='C:/Progra~1/R/R-3.2.3/library')
install.packages('shiny',lib='C:/Progra~1/R/R-3.2.3/library')
library('shiny',lib='C:/Progra~1/R/R-3.2.3/library')
library('shinythemes',lib='C:/Progra~1/R/R-3.2.3/library')
shiny::runApp('final_app')
library('ggplot2', lib = 'C:/Progra~1/R/R-3.2.3/library')
shiny::runApp('final_app')
shiny::runApp('final_app')
shiny::runApp('final_app')
c(5,13)
c(5,13) %>% class
ggplot(e(), aes(x = inv.mlsto, y = return.pdol, size = timespan)) +
geom_point() +
scale_size(range = c(5,13))
ggplot(b, aes(x = inv.mlsto, y = return.pdol, size = timespan)) +
geom_point() +
scale_size(range = c(5,13))
shiny::runApp('final_app')
library('shinythemes',lib='C:/Progra~1/R/R-3.2.3/library')
shiny::runApp('final_app')
shiny::runApp('final_app')
shiny::runApp('final_app')
library("plyr",lib = 'C:/Progra~1/R/R-3.2.3/library')
library("dplyr",lib = 'C:/Progra~1/R/R-3.2.3/library')
library('magrittr',lib='C:/Progra~1/R/R-3.2.3/library')
library('reshape2',lib='C:/Progra~1/R/R-3.2.3/library')
library('ggplot2',lib='C:/Progra~1/R/R-3.2.3/library')
library('gbm', lib = 'C:/Progra~1/R/R-3.2.3/library')
library('randomForest', lib = 'C:/Progra~1/R/R-3.2.3/library')
library('caret', lib = 'C:/Progra~1/R/R-3.2.3/library')
library('pROC',lib='C:/Progra~1/R/R-3.2.3/library')
all7d <- read.csv('C:/Users/n9232371/Documents/Consultbusiness/data/all7d.csv')
all10mice<- read.csv('C:/Users/n9232371/Documents/Consultbusiness/data/all10mice.csv')[,-1]
df.string = "all10mice"
method = "boost"
seed = 300
all10full = NULL
df = get(df.string)
set.seed(seed)
# create f.rpdol
df$f.rpdol <- as.factor(df$b.rpdol)
levels(df$f.rpdol)[levels(df$f.rpdol) == "0"] <-"profit"
levels(df$f.rpdol)[levels(df$f.rpdol) == "1"] <-"loss"
k.folds = 1
folds <- createFolds(df$f.rpdol, k = k.folds, list = T, returnTrain = F)
head(folds)
str(folds)
method %in% 'boost'
formula = "b.rpdol ~ Discipline + pc.pro + b.timespan.cbrt + no.users + inv.mlsto.log + client.totinv.log + Business + majority.pos + pc.majpos.log"
length(folds)
test<- df[folds[[j]],]
j=1
test<- df[folds[[j]],]
levels(test$f.rpdol) <- c('profit', 'loss')
test$f.rpdol <- ordered(test$f.rpdol)
fit <- gbm(as.formula(formula), data = df[-folds[[j]],],
distribution = "bernoulli", n.trees = 10000,
shrinkage = 0.001, interaction.depth = 4,
n.minobsinnode = 20)
df[-folds[[j]],]
head(df)
fit <- gbm(as.formula(formula), data = df, #[-folds[[j]],],
distribution = "bernoulli", n.trees = 10000,
shrinkage = 0.001, interaction.depth = 4,
n.minobsinnode = 20)
i=1
i=1
a<- plot.gbm(fit, i, type="response")
=======
p = ggplot(tbl, aes(x=Var1, y=Var2)) +
geom_tile(aes(fill=Freq), colour = 'white') +
scale_fill_gradient(low='white', high=colour, name = 'percent') +
labs(x='Profit measure', y='', title= 'percentage of jobs in each X-axis group') +
theme(axis.ticks=element_blank())+
scale_x_discrete(expand = c(0, 0)) + scale_y_discrete(expand = c(0, 0))
}
print(p)
}
heatmap(colour = 'deeppink3', clust = 'group.num', var = 'Biz.type', df=all7c, percentof_clust=FALSE)
heatmap(colour = 'deeppink3', clust = 'group.num', var = 'Num.disc', df=all7c, percentof_clust=FALSE)
heatmap(colour = 'deeppink3', clust = 'group.num', var = 'maj.pos', df=all7c, percentof_clust=FALSE)
heatmap(colour = 'deeppink3', clust = 'group.num', var = 'majority.pos', df=all7c, percentof_clust=FALSE)
heatmap(colour = 'deeppink3', clust = 'group.num', var = 'majority.pos', df=all7c, percentof_clust=TRUE)
heatmap(colour = 'deeppink3', clust = 'group.num', var = 'Billing.Type', df=all7c, percentof_clust=TRUE)
heatmap(colour = 'deeppink3', clust = 'group.num', var = 'Discipline', df=all7c, percentof_clust=TRUE)
heatmap(colour = 'deeppink3', clust = 'group.num', var = 'Discipline', df=all7c, percentof_clust=FALSE)
heatmap(colour = 'deeppink3', clust = 'group.num', var = 'code.client', df=all7c, percentof_clust=FALSE)
var = 'JD.Second'
ddply(all7c, c(var), summarise, sum(inv.mlsto))
ddply(all7c, c(var), summarise, summ = sum(inv.mlsto))
a[-order(a$summ),][,var]
a = ddply(df, c(var), summarise, summ = sum(inv.mlsto))
a[-order(a$summ),][,var]
-order(a$summ)
class(a$summ)
a[-order(a$summ),]
a
a$summ
order(a$summ)
-order(a$summ)
a[order(-a$summ),]
a[order(-a$summ),][,var]
levels(df[,var]) = factor(df[,var], levels= a[order(-a$summ),][,var])
tbl= round(prop.table(table(df[,clust],df[,var]),2)*100,2) %>% as.data.frame
p = ggplot(tbl, aes(x=Var2, y=Var1)) +
geom_tile(aes(fill=Freq), colour = 'white') +
scale_fill_gradient(low='white', high=colour, name = 'percent') +
labs(x='', y='', title= 'percentage of jobs in each Y-axis category') +
theme(axis.ticks=element_blank(),
axis.text.x=element_text(angle=45,hjust=1))+
scale_x_discrete(expand = c(0, 0)) + scale_y_discrete(expand = c(0, 0))
p
>>>>>>> Stashed changes
a
i=1
a<- plot.gbm(fit, i, type="response")
fit$var.names
i=3
a<- plot.gbm(fit, i, type="response")
levels(all10mice$b.timespan.cbrt)
levels(df$b.timespan.cbrt) <- c('1d-3wk', '3wk-2.5m','2.5m-9m','9m-1.5y','1.5y-3y','>3y')
levels(all10mice$b.timespan.cbrt)
levels(df$b.timespan.cbrt) <- c('1d-3wk', '3wk-2.5m','2.5m-9m','9m-1.5y','1.5y-3y','>3y')
df$b.timespan.cbrt <- ordered(df$b.timespan.cbrt)
levels(all10mice$b.timespan.cbrt)
df <- within(df, b.timespan.cbrt <- factor(b.timespan.cbrt,
levels=c('1d-3wk', '3wk-2.5m','2.5m-9m','9m-1.5y','1.5y-3y','>3y')))
levels(all10mice$b.timespan.cbrt)
levels(df$b.timespan.cbrt)
levels(df$no.users)
levels(df$majority.pos)
shiny::runApp('final_app')
df$inv.mlsto.log
df$inv.mlsto.log %>% levels
df$pc.pro %>% levels
df$pc.pro %>% head
df$majority.pos %>% head
df <- within(df, majority.pos <- factor(majority.pos,
levels=c('contracttech', 'midtech','seniortech','gradpro',
'midpro','seniorpro','director')))
levels(df$majority.pos)
fit <- gbm(as.formula(formula), data = df, #[-folds[[j]],],
distribution = "bernoulli", n.trees = 10000,
shrinkage = 0.001, interaction.depth = 4,
n.minobsinnode = 20)
i=3
a<- plot.gbm(fit, i, type="response")
a
<<<<<<< Updated upstream
fit$var.names
i=2
a<- plot.gbm(fit, i, type="response")
i=4
a<- plot.gbm(fit, i, type="response")
i=5
a<- plot.gbm(fit, i, type="response")
log(6)
e^6
exp(6)
exp(8)
exp(10)
exp(12)
exp(14)
shiny::runApp('final_app')
shiny::runApp('final_app')
library('shinythemes',lib='C:/Progra~1/R/R-3.2.3/library')
shiny::runApp('final_app')
df2
df
shiny::runApp('final_app')
df[1,]
shiny::runApp('final_app')
shiny::runApp('final_app')
?GBM
??gbm
shiny::runApp('final_app')
shiny::runApp('final_app')
shiny::runApp('final_app')
rep(0.3,11)
seq(0,100, by = 10)
shiny::runApp('final_app')
shiny::runApp('final_app')
seq(0,100, by = 2.5)
seq(0,100, by = 1)
length(seq(0,100, by = 10))
length(seq(0,100, by = 1))
shiny::runApp('final_app')
df2
df2<- data.frame(id=c(rep("Sp1",1)), ymin= c(63),
ymax=c(79), confidence=c('90%'))
df2 <- within(df2,
confidence <- factor(confidence,
levels=c('90%')))
df2
df2<- data.frame(id=c(rep("Sp1",1)), ymin= c(63), y.mean = c(71)
ymax=c(79), confidence=c('90%'))
df2<- data.frame(id=c(rep("Sp1",1)), ymin= c(63), y.mean = c(71),
ymax=c(79), confidence=c('90%'))
df2 <- within(df2,
confidence <- factor(confidence,
levels=c('90%')))
df2
shiny::runApp('final_app')
shiny::runApp('final_app')
df2
shiny::runApp('final_app')
shiny::runApp('final_app')
shiny::runApp('final_app')
shiny::runApp('final_app')
shiny::runApp('final_app')
install.packages('trelliscope', lib = 'C:/Progra~1/R/R-3.2.3/library')
install.packages('datadr', lib = 'C:/Progra~1/R/R-3.2.3/library')
shiny::runApp('final_app')
library('shinythemes',lib='C:/Progra~1/R/R-3.2.3/library')
shiny::runApp('final_app')
shiny::runApp('final_app')
shiny::runApp('final_app')
library('shinythemes',lib='C:/Progra~1/R/R-3.2.3/library')
shiny::runApp('final_app')
=======
factor(df[,var], levels= a[order(-a$summ),][,var])
levels= a[order(-a$summ),][,var]
levels
df[,var] = factor(df[,var], levels= a[order(-a$summ),][,var])
tbl= round(prop.table(table(df[,clust],df[,var]),2)*100,2) %>% as.data.frame
p = ggplot(tbl, aes(x=Var2, y=Var1)) +
geom_tile(aes(fill=Freq), colour = 'white') +
scale_fill_gradient(low='white', high=colour, name = 'percent') +
labs(x='', y='', title= 'percentage of jobs in each Y-axis category') +
theme(axis.ticks=element_blank(),
axis.text.x=element_text(angle=45,hjust=1))+
scale_x_discrete(expand = c(0, 0)) + scale_y_discrete(expand = c(0, 0))
p
clust.summary
heatmap<- function(colour = 'deeppink3', clust = 'group.num', var = 'JD.Second', df=all7c, percentof_clust=FALSE){
#order var levels by highest amount invoiced total
a = ddply(df, c(var), summarise, summ = sum(inv.mlsto))
df[,var] = factor(df[,var], levels= a[order(-a$summ),][,var])
if(percentof_clust== TRUE){
#table with percentages within each category
tbl= round(prop.table(table(df[,clust],df[,var]),2)*100,2) %>% as.data.frame
p = ggplot(tbl, aes(x=Var2, y=Var1)) +
geom_tile(aes(fill=Freq), colour = 'white') +
scale_fill_gradient(low='white', high=colour, name = 'percent') +
labs(x='', y='', title= 'percentage of jobs in each cluster') +
theme(axis.ticks=element_blank(),
axis.text.x=element_text(angle=45,hjust=1))+
scale_x_discrete(expand = c(0, 0)) + scale_y_discrete(expand = c(0, 0))
}
else{
#table with percentages within each cluster
tbl= round(prop.table(table(df[,clust],df[,var]),1)*100,2) %>% as.data.frame
p = ggplot(tbl, aes(x=Var2, y=Var1)) +
geom_tile(aes(fill=Freq), colour = 'white') +
scale_fill_gradient(low='white', high=colour, name = 'percent') +
labs(x='Profit measure', y='', title= 'percentage of jobs in each X-axis category') +
theme(axis.ticks=element_blank(),
axis.text.x=element_text(angle=45,hjust=1))+
scale_x_discrete(expand = c(0, 0)) + scale_y_discrete(expand = c(0, 0))
}
print(p)
}
heatmap(colour = 'deeppink3', clust = 'group.num', var = 'JD.Second', df=all7c, percentof_clust=FALSE)
heatmap(colour = 'deeppink3', clust = 'group.num', var = 'JD.Second', df=all7c, percentof_clust=TRUE)
heatmap<- function(colour = 'deeppink3', clust = 'group.num', var = 'JD.Second', df=all7c, percentof_clust=FALSE){
#order var levels by highest amount invoiced total
a = ddply(df, c(var), summarise, summ = sum(inv.mlsto))
df[,var] = factor(df[,var], levels= a[order(-a$summ),][,var])
if(percentof_clust== FALSE){
#table with percentages within each category
tbl= round(prop.table(table(df[,clust],df[,var]),2)*100,2) %>% as.data.frame
p = ggplot(tbl, aes(x=Var2, y=Var1)) +
geom_tile(aes(fill=Freq), colour = 'white') +
scale_fill_gradient(low='white', high=colour, name = 'percent') +
labs(x='', y='', title= 'percentage of jobs in each cluster') +
theme(axis.ticks=element_blank(),
axis.text.x=element_text(angle=45,hjust=1))+
scale_x_discrete(expand = c(0, 0)) + scale_y_discrete(expand = c(0, 0))
}
else{
#table with percentages within each cluster
tbl= round(prop.table(table(df[,clust],df[,var]),1)*100,2) %>% as.data.frame
p = ggplot(tbl, aes(x=Var2, y=Var1)) +
geom_tile(aes(fill=Freq), colour = 'white') +
scale_fill_gradient(low='white', high=colour, name = 'percent') +
labs(x='Profit measure', y='', title= 'percentage of jobs in each X-axis category') +
theme(axis.ticks=element_blank(),
axis.text.x=element_text(angle=45,hjust=1))+
scale_x_discrete(expand = c(0, 0)) + scale_y_discrete(expand = c(0, 0))
}
print(p)
}
heatmap(colour = 'deeppink3', clust = 'group.num', var = 'JD.Second', df=all7c, percentof_clust=FALSE)
heatmap<- function(colour = 'deeppink3', clust = 'group.num', var = 'JD.Second', df=all7c, percentof_clust=FALSE){
#order var levels by highest amount invoiced total
a = ddply(df, c(var), summarise, summ = sum(inv.mlsto))
df[,var] = factor(df[,var], levels= a[order(-a$summ),][,var])
if(percentof_clust== TRUE){
#table with percentages within each category
tbl= round(prop.table(table(df[,clust],df[,var]),2)*100,2) %>% as.data.frame
p = ggplot(tbl, aes(x=Var2, y=Var1)) +
geom_tile(aes(fill=Freq), colour = 'white') +
scale_fill_gradient(low='white', high=colour, name = 'percent') +
labs(x='', y='', title= 'percentage of jobs in each cluster') +
theme(axis.ticks=element_blank(),
axis.text.x=element_text(angle=45,hjust=1))+
scale_x_discrete(expand = c(0, 0)) + scale_y_discrete(expand = c(0, 0))
}
else{
#table with percentages within each cluster
tbl= round(prop.table(table(df[,clust],df[,var]),1)*100,2) %>% as.data.frame
p = ggplot(tbl, aes(x=Var2, y=Var1)) +
geom_tile(aes(fill=Freq), colour = 'white') +
scale_fill_gradient(low='white', high=colour, name = 'percent') +
labs(x='Profit measure', y='', title= 'percentage of jobs in each X-axis category') +
theme(axis.ticks=element_blank(),
axis.text.x=element_text(angle=45,hjust=1))+
scale_x_discrete(expand = c(0, 0)) + scale_y_discrete(expand = c(0, 0))
}
print(p)
}
heatmap(colour = 'deeppink3', clust = 'group.num', var = 'JD.Second', df=all7c, percentof_clust=FALSE)
heatmap<- function(colour = 'deeppink3', clust = 'group.num', var = 'JD.Second', df=all7c, percentof_clust=FALSE){
#order var levels by highest amount invoiced total
a = ddply(df, c(var), summarise, summ = sum(inv.mlsto))
df[,var] = factor(df[,var], levels= a[order(-a$summ),][,var])
if(percentof_clust== FALSE){
#table with percentages within each category
tbl= round(prop.table(table(df[,clust],df[,var]),2)*100,2) %>% as.data.frame
p = ggplot(tbl, aes(x=Var2, y=Var1)) +
geom_tile(aes(fill=Freq), colour = 'white') +
scale_fill_gradient(low='white', high=colour, name = 'percent') +
labs(x='', y='', title= 'percentage of jobs in each cluster') +
theme(axis.ticks=element_blank(),
axis.text.x=element_text(angle=45,hjust=1))+
scale_x_discrete(expand = c(0, 0)) + scale_y_discrete(expand = c(0, 0))
}
else{
#table with percentages within each cluster
tbl= round(prop.table(table(df[,clust],df[,var]),1)*100,2) %>% as.data.frame
p = ggplot(tbl, aes(x=Var2, y=Var1)) +
geom_tile(aes(fill=Freq), colour = 'white') +
scale_fill_gradient(low='white', high=colour, name = 'percent') +
labs(x='Profit measure', y='', title= 'percentage of jobs in each X-axis category') +
theme(axis.ticks=element_blank(),
axis.text.x=element_text(angle=45,hjust=1))+
scale_x_discrete(expand = c(0, 0)) + scale_y_discrete(expand = c(0, 0))
}
print(p)
}
heatmap(colour = 'deeppink3', clust = 'group.num', var = 'JD.Second', df=all7c, percentof_clust=FALSE)
heatmap<- function(colour = 'deeppink3', clust = 'group.num', var = 'JD.Second', df=all7c, percentof_clust=FALSE){
#order var levels by highest amount invoiced total
a = ddply(df, c(var), summarise, summ = sum(inv.mlsto))
df[,var] = factor(df[,var], levels= a[order(-a$summ),][,var])
if(percentof_clust== FALSE){
#table with percentages within each category
tbl= round(prop.table(table(df[,clust],df[,var]),1)*100,2) %>% as.data.frame
p = ggplot(tbl, aes(x=Var2, y=Var1)) +
geom_tile(aes(fill=Freq), colour = 'white') +
scale_fill_gradient(low='white', high=colour, name = 'percent') +
labs(x='', y='', title= 'percentage of jobs in each cluster') +
theme(axis.ticks=element_blank(),
axis.text.x=element_text(angle=45,hjust=1))+
scale_x_discrete(expand = c(0, 0)) + scale_y_discrete(expand = c(0, 0))
}
else{
#table with percentages within each cluster
tbl= round(prop.table(table(df[,clust],df[,var]),2)*100,2) %>% as.data.frame
p = ggplot(tbl, aes(x=Var2, y=Var1)) +
geom_tile(aes(fill=Freq), colour = 'white') +
scale_fill_gradient(low='white', high=colour, name = 'percent') +
labs(x='Profit measure', y='', title= 'percentage of jobs in each X-axis category') +
theme(axis.ticks=element_blank(),
axis.text.x=element_text(angle=45,hjust=1))+
scale_x_discrete(expand = c(0, 0)) + scale_y_discrete(expand = c(0, 0))
}
print(p)
}
heatmap(colour = 'deeppink3', clust = 'group.num', var = 'JD.Second', df=all7c, percentof_clust=FALSE)
heatmap(colour = 'deeppink3', clust = 'group.num', var = 'majority.pos', df=all7c, percentof_clust=FALSE)
heatmap(colour = 'deeppink3', clust = 'group.num', var = 'majority.pos', df=all7c, percentof_clust=TRUE)
heatmap(colour = 'deeppink3', clust = 'group.num', var = 'Billing.Type', df=all7c, percentof_clust=TRUE)
heatmap(colour = 'deeppink3', clust = 'group.num', var = 'Discipline', df=all7c, percentof_clust=TRUE)
heatmap(colour = 'deeppink3', clust = 'group.num', var = 'code.client', df=all7c, percentof_clust=FALSE)
heatmap(colour = 'deeppink3', clust = 'group.num', var = 'code.client', df=all7c, percentof_clust=TRUE)
heatmap(colour = 'deeppink3', clust = 'group.num', var = 'code.contact', df=all7c, percentof_clust=FALSE)
heatmap(colour = 'deeppink3', clust = 'group.num', var = 'code.contact', df=all7c, percentof_clust=TRUE)
clust.summary
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
install.packages('extrafont')
library('extrafont')
source('~/.active-rstudio-document', echo=TRUE)
?loadfonts
loadfonts(device='win')
loadfonts(device='pdf')
source('~/.active-rstudio-document', echo=TRUE)
p= ggplot(sub10 %>% filter(variable == 'pc.seniorpro', Discipline == 'Structural'), aes(x=percent.hrs, y= return.cut, colour= 'blue')) +
geom_smooth(method=loess, se=TRUE, aes(fill='blue'), alpha=.35) +
#                                 stat_summary(fun.x= mean, geom='point', shape = 2) +
#stat_summary(fun.data= mean_sdl, geom='crossbar', mult =1) +
theme(legend.position="none",
axis.text.x=element_text(angle=45,hjust=1),
text=element_text(size=12) ,
plot.title = element_text(size=11, family= 'Times New Roman', face='plain'),
axis.title.y = element_text(size = 9, family= 'Times New Roman'),
axis.title.x = element_text(size=9, family= 'Times New Roman'),
axis.text = element_text(size = 7.5),
panel.background = element_rect(fill = "gray96"),
panel.grid.major = element_line(colour='white' ),
axis.ticks= element_line( colour='gray85')
) +
scale_x_continuous(breaks = seq(0, 100, by = 10), limits=c(0,100)) +
scale_y_continuous(breaks = seq(1, 10, by = 1), limits=c(1,10)) +
# facet_wrap(~ variable) + , labeller =  label_value(variable, c('a','b','c','d','e','f','g','h')) +
geom_point(aes(colour = 'blue'), alpha = 0.5) +
theme(strip.text = element_text(colour = 'white'), strip.background = element_rect(fill = 'black')) +
labs(x = '% Contribution by hours of Senior Professional',
y = 'Return per Dollar Category', title=
'Senior Professional % Contribution vs Return Category')
p
ggsave(p,filename='senior_pro.png',path='~/OneDrive/shared files/conferences/Visualisation')
ggsave(p,filename='senior_pro.png',path='~/OneDrive/shared files/conferences/Visualisation')
ggsave(p,filename='senior_pro.png',path='~/OneDrive/shared files/conferences/Visualisation')
p= ggplot(sub10 %>% filter(variable == 'pc.seniorpro', Discipline == 'Structural'), aes(x=percent.hrs, y= return.cut, colour= 'blue')) +
geom_smooth(method=loess, se=TRUE, aes(fill='blue'), alpha=.35) +
#                                 stat_summary(fun.x= mean, geom='point', shape = 2) +
#stat_summary(fun.data= mean_sdl, geom='crossbar', mult =1) +
theme(legend.position="none",
axis.text.x=element_text(angle=45,hjust=1),
text=element_text(size=12) ,
plot.title = element_text(size=12, family= 'Times New Roman', face='plain'),
axis.title.y = element_text(size = 10, family= 'Times New Roman'),
axis.title.x = element_text(size=10, family= 'Times New Roman'),
axis.text = element_text(size = 8.5),
panel.background = element_rect(fill = "gray96"),
panel.grid.major = element_line(colour='white' ),
axis.ticks= element_line( colour='gray85')
) +
scale_x_continuous(breaks = seq(0, 100, by = 10), limits=c(0,100)) +
scale_y_continuous(breaks = seq(1, 10, by = 1), limits=c(1,10)) +
# facet_wrap(~ variable) + , labeller =  label_value(variable, c('a','b','c','d','e','f','g','h')) +
geom_point(aes(colour = 'blue'), alpha = 0.5) +
theme(strip.text = element_text(colour = 'white'), strip.background = element_rect(fill = 'black')) +
labs(x = '% Contribution by hours of Senior Professional',
y = 'Return per Dollar Category', title=
'Senior Professional % Contribution vs Return Category')
p
p= ggplot(sub10 %>% filter(variable == 'pc.seniorpro', Discipline == 'Structural'), aes(x=percent.hrs, y= return.cut, colour= 'blue')) +
geom_smooth(method=loess, se=TRUE, aes(fill='blue'), alpha=.35) +
#                                 stat_summary(fun.x= mean, geom='point', shape = 2) +
#stat_summary(fun.data= mean_sdl, geom='crossbar', mult =1) +
theme(legend.position="none",
axis.text.x=element_text(angle=45,hjust=1),
text=element_text(size=12) ,
plot.title = element_text(size=13, family= 'Times New Roman', face='plain'),
axis.title.y = element_text(size = 11, family= 'Times New Roman'),
axis.title.x = element_text(size=11, family= 'Times New Roman'),
axis.text = element_text(size = 8.5),
panel.background = element_rect(fill = "gray96"),
panel.grid.major = element_line(colour='white' ),
axis.ticks= element_line( colour='gray85')
) +
scale_x_continuous(breaks = seq(0, 100, by = 10), limits=c(0,100)) +
scale_y_continuous(breaks = seq(1, 10, by = 1), limits=c(1,10)) +
# facet_wrap(~ variable) + , labeller =  label_value(variable, c('a','b','c','d','e','f','g','h')) +
geom_point(aes(colour = 'blue'), alpha = 0.5) +
theme(strip.text = element_text(colour = 'white'), strip.background = element_rect(fill = 'black')) +
labs(x = '% Contribution by hours of Senior Professional',
y = 'Return per Dollar Category', title=
'Senior Professional % Contribution vs Return Category')
p
ggsave(p,filename='senior_pro.png',path='~/OneDrive/shared files/conferences/Visualisation')
?update.packages
update.packages(lib.loc = 'C:/Progra~1/R/R-3.2.3/library',
checkBuilt=TRUE, ask=FALSE)
library('ggplot2', lib = 'C:/Progra~1/R/R-3.2.3/library')
update.packages(lib.loc = 'C:/Progra~1/R/R-3.2.3/library',
instlib = 'C:/Progra~1/R/R-3.2.3/library',
checkBuilt=TRUE, ask=FALSE)
library('ggplot2', lib = 'C:/Progra~1/R/R-3.2.3/library')
install.packages('ggplot2', lib = 'C:/Progra~1/R/R-3.2.3/library')
install.packages("ggplot2", lib = "C:/Progra~1/R/R-3.2.3/library")
library('ggplot2', lib = 'C:/Progra~1/R/R-3.2.3/library')
library('tidyr', lib = 'C:/Progra~1/R/R-3.2.3/library')
install.packages('tidyr', lib = 'C:/Progra~1/R/R-3.2.3/library')
library('tidyr', lib = 'C:/Progra~1/R/R-3.2.3/library')
library('Rcpp', lib = 'C:/Progra~1/R/R-3.2.3/library')
library('rmarkdown',lib='C:/Progra~1/R/R-3.2.3/library')
ggplot(mpg, aes(cty, hwy)) +
geom_point()
ggplot(mpg, aes(cty, hwy)) +
geom_count()
library('ggplot2')
head(iris)
summary(iris)
ggplot( data = iris, aes(x = Petal.Length, y = Petal.Width)) +
geom_point()
ggplot( data = iris, aes(x = Petal.Length, y = Petal.Width)) +
geom_point() +
labs(x = "petaltal length", y = 'petaltal width')
ggplot( data = iris, aes(x = Petal.Length, y = Petal.Width)) +
geom_point() +
labs(x = "petaltal length", y = 'petaltal width',
title = 'Iris species petal dimensions')
ggplot( data = iris, aes(x = Petal.Length, y = Petal.Width)) +
geom_point( aes(colour = Species)) +
labs(x = "petaltal length", y = 'petaltal width',
title = 'Iris species petal dimensions')
ggplot( data = iris, aes(x = Petal.Length, y = Petal.Width)) +
geom_point( aes(colour = Species)) +
labs(x = "petaltal length", y = 'petaltal width',
title = 'Iris species petal dimensions') +
scale_colour_brewer(palette = "Greens")
ggplot( data = iris, aes(x = Petal.Length, y = Petal.Width)) +
geom_point( aes(colour = Species)) +
geom_line()
labs(x = "petaltal length", y = 'petaltal width',
title = 'Iris species petal dimensions') +
scale_colour_brewer(palette = "Greens")
ggplot( data = iris, aes(x = Petal.Length, y = Petal.Width)) +
geom_point( aes(colour = Species)) +
geom_line() +
labs(x = "petaltal length", y = 'petaltal width',
title = 'Iris species petal dimensions') +
scale_colour_brewer(palette = "Greens")
ggplot( data = iris, aes(x = Petal.Length, y = Petal.Width)) +
geom_point( aes(colour = Species)) +
geom_line(aes(colour = Species)) +
labs(x = "petaltal length", y = 'petaltal width',
title = 'Iris species petal dimensions') +
scale_colour_brewer(palette = "Greens")
head(faithfuld)
?faithfuld
??faithfuld
ggplot(faithful) +
geom_tile(aes(waiting, eruptions, fill = density))
head(faithful)
head(faithful)
str(faithful)
library('corrgram')
?mosaicplot
library('party', lib = 'C:/Progra~1/R/R-3.2.1/library')
library('party')
?cforest
table(iris$Species)
table(iris$Species) %>% class
library('magrittr')
table(iris$Species) %>% class
library('ggplot2')
head(diamonds)
diamonds2 <- diamonds %>% slice(1:300)
library('magrittr')
library('dplyr')
diamonds2 <- diamonds %>% slice(1:300)
summary(diamonds2)
summary(diamonds2)
View(diamonds2)
ggplot(data = diamonds2, aes(x = carat, y = price)) +
geom_point()
ggplot(data = diamonds, aes(x = carat, y = price)) +
geom_point()
library('FNN')
?knn
summary(dimaonds)
summary(diamonds)
?ggplot
ggplot(data = diamonds, aes(x = carat, y = price, colour = cut)) +
geom_point()
nrow(diamonds)
?sample
diamonds2 <- diamonds %>% slice(sample(1000, 1:53940))
dim(diamonds)
dim(diamonds2)
?sample
diamonds2 <- diamonds %>% slice(sample( 1:53940, 1000))
dim(diamonds2)
ggplot(data = diamonds2, aes(x = carat, y = price, colour = cut)) +
geom_point()
ggplot(data = diamonds2, aes(x = carat, y = price, colour = clarity)) +
geom_point()
ggplot(data = diamonds2, aes(x = carat, y = price, fill = clarity)) +
geom_bar(stat = 'bin')
ggplot(data = diamonds2, aes(x = carat, fill = clarity)) +
geom_bar(stat = 'bin')
ggplot(data = diamonds2, aes(x = carat, fill = clarity)) +
geom_boxplot()
ggplot(data = diamonds2, aes(x = carat, y= price, fill = clarity)) +
geom_boxplot()
ggplot(data = diamonds2, aes(x = carat, y= price)) +
geom_boxplot()
summary(diamonds)
str(diamonds)
ggplot(data = diamonds2, aes(x = clarity, y= price)) +
geom_boxplot()
ggplot(data = diamonds2, aes(x = clarity, y= price)) +
geom_boxplot() +
geom_jitter()
ggplot(data = diamonds2, aes(x = clarity, y= price)) +
geom_boxplot() +
geom_jitter(alpha = 0.3)
ggplot(data = diamonds, aes(x = clarity, y= price)) +
geom_boxplot() +
geom_jitter(alpha = 0.3)
ggplot(data = diamonds2, aes(x = clarity, y= price)) +
geom_boxplot() +
geom_jitter(alpha = 0.3)
ggplot(data = diamonds2, aes(x = clarity, y= price, colour = clarity)) +
geom_boxplot() +
geom_jitter(alpha = 0.3)
ggplot(data = diamonds2, aes(x = carat, y= price, colour = clarity)) +
geom_point()
ggplot(data = diamonds, aes(x = carat, y= price, colour = clarity)) +
geom_point()
ggplot(data = diamonds, aes(x = carat, y= price, colour = clarity)) +
geom_point(alpha = 0.5)
summary(diamonds)
ggplot(data = diamonds, aes(x = carat, y= price, colour = clarity, size = carat)) +
geom_point(alpha = 0.5)
ggplot(data = diamonds, aes(x = carat, y= price, colour = clarity, size = cut)) +
geom_point(alpha = 0.5)
ggplot(data = diamonds, aes(x = carat, y= price, colour = clarity, size = cut)) +
geom_point(alpha = 0.5) +
scale_colour_brewer(palette = "Greens")
max(diamonds$price)
diamonds %>% filter(carat < 1, cut %in% c('Premium', 'Ideal')) %>% summary
library('shiny')
runApp('~/OneDrive/shared files/Statslearningcourse/Shiny/tutorial/trial1')
runApp('~/OneDrive/shared files/Statslearningcourse/Shiny/tutorial/trial1')
head(diamonds)
ggplot(diamonds, aes(x = carat, y = price, colour = depth)) +
geom_point() +
facet_wrap(~color)
ggplot(diamonds, aes(x = carat, y = price, colour = color)) +
geom_point() +
facet_wrap(~color)
ggplot(diamonds, aes(x = carat, y = price)) +
geom_tile(aes(fill = color))
ggplot(diamonds, aes(x = cut, y = clarity)) +
geom_tile(aes(fill = color))
ggplot(diamonds, aes(x = cut, y = clarity)) +
geom_tile(aes(fill = price))
head(diamonds)
ggplot(diamonds, aes(x = carat, y = clarity)) +
geom_tile(aes(fill = price))
?diamonds
ggplot(diamonds2, aes(x = carat, y = price)) +
geom_point(aes(colour = depth)) +
facet_wrap(~color) +
geom_smooth()
temp <- c(11, 18, 15, 25, 16, 12, 32, 24,28,14)
mean(temp)
sd(temp)
order(temp)
sort(temp)
sd(temp)
(11-19.5)^2
x = temp - 19.5
x
x^2
18-19.5^2
18-19.5
-15^2
-1.5^2
sum(x^2)
temp <-sort(temp)
x = temp - 19.5
x
x^2
18-19.5
-1.5^2
sd(temp)
temp
temp <- c(11, 18, 15, 25, 16, 12, 82, 24,28,14)
mean(temp)
temp <-sort(temp)
>>>>>>> Stashed changes
